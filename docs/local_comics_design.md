# 本地漫画设计规范（首版）

## 目标与范围
- 平台：Android + iOS
- iOS 访问范围：仅应用沙盒内导入的文件夹/CBZ
- 目录规范：强制“一个漫画=一个文件夹/CBZ”
- 支持格式：图片文件夹 + CBZ（zip）

## 文件与图片格式
- 支持图片：`jpg/jpeg/png/webp`
- 图片读取顺序：按文件名自然排序（如 `001.jpg`、`1.jpg`、`chapter_01.png`）
- 允许混合尺寸与方向；应用不做尺寸强校验
- 忽略隐藏文件（以 `.` 开头）与非图片文件

## CBZ 结构约定
- CBZ 作为“单话/单卷容器”
- 仅扫描 CBZ 根目录下的图片文件（忽略子目录）
- 图片按文件名自然排序

## 目录组织规范
根目录由用户选择或导入（iOS 通过导入至应用沙盒）。

### 漫画层级
一级文件夹即漫画：
```
LibraryRoot/
  MangaTitle/
```

### 章节层级（推荐）
漫画文件夹下的子文件夹或 CBZ 代表章节：
```
MangaTitle/
  Chapter_001/
    001.jpg
    002.jpg
  Chapter_002.cbz
```

### 单话漫画（允许）
漫画文件夹下直接放图片（视为单话）：
```
MangaTitle/
  001.jpg
  002.jpg
```

## 识别与解析策略
- 漫画级别：一级文件夹即漫画
- 章节级别：漫画文件夹下的子文件夹或 CBZ
- 章节内图片：只扫描支持格式
- 章节排序：按文件夹/CBZ 名称自然排序

## 元数据策略（首版）
- 默认从目录/文件名推断漫画名与章节号
- 不强制内置元数据文件
- 后续可扩展支持 `metadata.json` 或 `ComicInfo.xml`

## 平台访问约束
### Android
- 通过 SAF/系统文件选择器授权根目录或单个漫画目录
- 需要持久化访问权限（例如 `persistedUriPermissions`）
- 本地扫描在 KMP 层封装为 `expect/actual`

### iOS
- 仅支持导入至应用沙盒（Files 导入或应用内导入）
- 不做系统目录扫描
- 文件访问通过 `expect/actual` 封装

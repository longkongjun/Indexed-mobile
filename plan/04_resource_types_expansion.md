# 资源类型扩展

本文档汇总各资源类型的**支持格式、分类整理规则、刮削规则**。刮削规则**优先沿用已有通用方案**（如影视 NFO、漫画 ComicInfo.xml、音乐内嵌标签、小说内嵌元数据），便于与 Kodi/Emby/Jellyfin、ComicRack、MusicBrainz 等生态兼容。详细目录结构与示例见 [资源支持说明](./未归档/08_resource_support.md)。

---

## 一、格式汇总

| 资源类型 | 类型标识 | 支持格式（扩展名） | 说明 |
|----------|----------|--------------------|------|
| 漫画 | `comic` | jpg, jpeg, png, webp | 图片文件夹，按文件名自然排序 |
| 漫画 | `comic` | .cbz | ZIP 内为图片，按文件名排序 |
| 漫画 | `comic` | .cbr | RAR 内为图片 |
| 漫画 | `comic` | .pdf, .epub | 单文件漫画/电子书漫画 |
| 影视 | `video` | .mp4, .mkv, .avi, .mov, .webm | 视频容器；字幕 .srt, .ass, .vtt 同目录或同名 |
| 音乐 | `music` | .mp3, .flac, .aac, .m4a, .ogg, .wav | 音频；封面 cover.jpg / albumart.* 放专辑目录 |
| 小说 | `novel` | .txt, .epub, .mobi, .pdf, .fb2 | 电子书；分章可为单文件或目录内多 TXT |

---

## 二、刮削规则（优先沿用通用方案）

刮削顺序统一为：**本地通用元数据（优先）→ 远程 API（按配置）→ 文件名/目录名解析（兜底）**。

### 2.1 影视（Video）— NFO 标准

沿用 **Kodi / Emby / Jellyfin** 通用的 NFO 描述文件，无需自创格式。

| 方式 | 说明 | 优先级 |
|------|------|--------|
| **本地 NFO** | 与视频同目录、同名 `*.nfo`，或目录下 `movie.nfo` / `tvshow.nfo`；XML 含片名、年份、tmdbid/imdbid、集数 SxxExx 等 | 高（优先） |
| TMDB / 豆瓣电影 / IMDb | 远程 API；NFO 中可写入 `tmdbid`/`imdbid` 做唯一关联，避免重复刮削 | 高 |
| 文件名/目录名解析 | 正则提取片名、年份、SxxExx | 兜底 |

- **NFO 约定**：兼容 Kodi 的 `movie.nfo`、`tvshow.nfo`、单集 `S01E01.nfo`；刮削结果可写回 NFO，便于其他媒体中心共用。

### 2.2 漫画（Comic）— ComicInfo.xml / metadata.json

沿用 **ComicRack** 等通用方案 + 常见 JSON 约定。

| 方式 | 说明 | 优先级 |
|------|------|--------|
| **本地 ComicInfo.xml** | CBZ/CBR 包内或作品目录下；标准漫画元数据 XML，兼容 ComicRack | 高（优先） |
| **本地 metadata.json** | 作品目录下 `metadata.json`；自定义 JSON，标题、作者、卷/话等 | 高（优先） |
| MyAnimeList / AniList / Kitsu / ComicVine | 远程 API，按标题/ISBN 匹配 | 高/中 |
| 文件名/目录名解析 | 正则提取标题、话数、卷号 | 兜底 |

### 2.3 音乐（Music）— 内嵌标签标准

沿用 **ID3（MP3）/ Vorbis Comment（FLAC）** 等文件内嵌元数据，无需额外描述文件。

| 方式 | 说明 | 优先级 |
|------|------|--------|
| **内嵌标签** | ID3（MP3）、Vorbis Comment（FLAC）、AAC/MP4 元数据；艺术家、专辑、曲序、年份、封面 | 高（优先） |
| **封面文件** | 专辑目录下 `cover.jpg`、`albumart.*`；读取后可选写入内嵌或保留文件 | 高 |
| MusicBrainz / Last.fm / Discogs | 远程 API；可写回内嵌标签或 MusicBrainz ID 做唯一关联 | 高/中 |
| 文件名/目录名解析 | 艺术家/专辑/曲序-曲名 | 兜底 |

### 2.4 小说（Novel）— 内嵌元数据标准

沿用 **EPUB / MOBI** 等电子书内嵌元数据，无通用“描述文件”时以文件内为准。

| 方式 | 说明 | 优先级 |
|------|------|--------|
| **EPUB/MOBI 内嵌元数据** | 书名、作者、ISBN、目录等；整理时以文件内为准或刮削后写回 | 高（优先） |
| Goodreads / 豆瓣读书 | 按 ISBN/书名/作者匹配 | 高 |
| 文件名/目录名解析 | 书名、作者、章节号 | 兜底 |

### 2.5 刮削规则小结

| 资源类型 | 推荐本地通用方案 | 常用远程源 | 兜底 |
|----------|------------------|------------|------|
| 影视 | NFO（Kodi/Emby/Jellyfin 兼容） | TMDB、豆瓣、IMDb | 文件名/目录解析 |
| 漫画 | ComicInfo.xml、metadata.json | MAL、AniList、Kitsu、ComicVine | 文件名/目录解析 |
| 音乐 | ID3 / Vorbis Comment、cover.jpg | MusicBrainz、Last.fm、Discogs | 文件名/目录解析 |
| 小说 | EPUB/MOBI 内嵌 | Goodreads、豆瓣读书 | 文件名/目录解析 |

---

## 三、分类整理规则

### 3.1 分类维度与目录结构

| 资源类型 | 分类维度 | 推荐目录结构示例 |
|----------|----------|------------------|
| 漫画 | 作品 → 卷/话 | `{作品名}/` → `第{n}话/` 或 `{n}.cbz`；作品目录可带 `({年份})` |
| 影视 | 电影单文件或单目录；剧集按季→集 | 电影：`{片名} ({年份})/`；剧集：`{剧集名}/Season {n}/S{n}E{m} - {集标题}.{ext}` |
| 音乐 | 艺术家 → 专辑 → 曲目 | `{艺术家}/` → `{专辑名} ({年份})/` → `{曲序} - {曲名}.{ext}` |
| 小说 | 书名（或作者）→ 卷/章 | `{书名}/` 或 `{作者} - {书名}/`；单本 `{书名}.epub`；分章 `第{n}章.txt` |

### 3.2 命名规则（规则引擎可配置）

| 资源类型 | 作品/集合级 | 单集/章节/曲目级 |
|----------|-------------|------------------|
| 漫画 | `{标题} ({年份})` 或 `{标题}` | `第{n}话`、`Ch{n}`、`{标题} - {n}.cbz` |
| 影视-电影 | `{片名} ({年份}).{分辨率}.{片源}.{ext}` | — |
| 影视-剧集 | `{剧集名}/Season {n}/` | `S{season}E{episode} - {集标题}.{ext}` |
| 音乐 | `{专辑名} ({年份})` | `{曲序} - {曲名}.{ext}` 或 `{曲序}.{曲名}.{ext}` |
| 小说 | `{书名}` 或 `{作者} - {书名}` | `{书名}.epub`；分章 `第{n}章.txt`、`Ch{n}.txt` |

### 3.3 整理动作（规则引擎支持）

- **重命名**：按上述模板与刮削得到的元数据生成新文件名/目录名。
- **移动/归档**：将资源移动到目标目录结构（如按类型、年份、标签分目录）。
- **打标签**：为资源写入标签，便于筛选与分组。
- **写回元数据**：影视写 NFO、漫画写 ComicInfo/metadata.json、音乐写内嵌标签或 cover 文件、小说写 EPUB 内嵌（若实现支持）。
- **字幕/封面**：影视字幕与正片同目录或同名；音乐封面 `cover.jpg` 放专辑目录；小说可选 `cover.jpg` 放书名目录。

---

## 四、元数据格式与位置（本地通用方案速查）

| 资源类型 | 格式 | 位置/命名 | 说明 |
|----------|------|------------|------|
| 影视 | NFO | 与视频同目录、同名 `*.nfo`，或 `movie.nfo` / `tvshow.nfo` | Kodi/Emby/Jellyfin 兼容 XML |
| 漫画 | ComicInfo.xml | CBZ/CBR 包内或作品目录下 | ComicRack 兼容 XML |
| 漫画 | metadata.json | 作品目录下 `metadata.json` | 自定义 JSON |
| 音乐 | ID3 / Vorbis Comment 等 | 内嵌于音频文件 | 标准内嵌标签 |
| 音乐 | cover.jpg / albumart.* | 专辑目录下 | 封面图 |
| 小说 | EPUB/MOBI 内嵌 | 电子书文件内 | 书名、作者、ISBN、目录 |
| 影视-字幕 | SRT/ASS/VTT | 与视频同目录、同名或 `*.zh.srt` | 按语言后缀区分 |

---

## 五、自定义类型

- 通过**插件**扩展新资源类型；格式、刮削方式、分类整理规则均由插件与规则引擎定义。
- 与上述四类共用同一套配置与规则入口；**元数据格式建议优先采用该领域已有通用方案**（如新类型若有“描述文件”可参考 NFO/ComicInfo 的 XML 或 JSON 约定），便于与其他工具互操作。

---

**最后更新**：2026-02-04 · 版本 1.1.0

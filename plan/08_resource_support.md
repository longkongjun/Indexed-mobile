# 资源支持说明

本文档说明各资源类型的**支持格式、源文件结构、刮削方式、分类整理方式**，便于实现与配置时查阅。扩展规划与实现计划见 [资源类型扩展规划](./04_resource_types_expansion.md)。

---

## 总览

| 资源类型 | 格式示例 | 刮削方式 | 分类整理要点 |
|----------|----------|----------|--------------|
| 漫画 | 图片文件夹、CBZ/CBR、PDF | MAL/AniList/本地 | 按作品→章节；文件名/目录规则 |
| 影视 | MP4/MKV、目录 | TMDB/豆瓣/NFO | 电影/剧集分季；SxxExx 命名 |
| 音乐 | MP3/FLAC、专辑目录 | MusicBrainz/ID3 | 艺术家→专辑→曲目；标签规则 |
| 小说 | TXT/EPUB/MOBI、目录 | Goodreads/豆瓣/EPUB 内嵌 | 按书名/作者；章节文件命名 |

---

## 1. 漫画（Comic）

### 资源类型

- 类型标识：`comic`
- 最小单位：单话/卷（章节）或单本
- 支持自定义类型扩展

### 支持格式

| 格式 | 扩展名 | 说明 | 优先级 |
|------|--------|------|--------|
| 图片文件夹 | jpg, png, webp | 按目录或压缩包内顺序 | 高 |
| CBZ | .cbz | ZIP 内为图片，按文件名排序 | 高 |
| CBR | .cbr | RAR 内为图片 | 中 |
| PDF | .pdf | 单文件漫画 | 中 |
| EPUB | .epub | 电子书格式漫画 | 低 |

### 源文件与目录结构

```
库根目录/
├── 作品名A/
│   ├── 第01话/           # 或 001、Chapter_01
│   │   ├── 001.jpg
│   │   ├── 002.png
│   │   └── ...
│   ├── 第02话.cbz
│   └── metadata.json     # 可选，本地元数据
├── 作品名B/
│   └── 全集.pdf
└── ...
```

- **源文件**：上述目录下的图片文件、.cbz/.cbr/.pdf/.epub；可含 `metadata.json`、`ComicInfo.xml` 等本地元数据。

### 刮削方式

| 方式 | 说明 | 优先级 |
|------|------|--------|
| 本地 metadata.json / ComicInfo.xml | 解析本地文件内元数据 | 高（优先） |
| MyAnimeList (MAL) | 按标题/ISBN 匹配 | 高 |
| AniList / Kitsu | 按标题匹配 | 中 |
| ComicVine | 美漫等 | 中 |
| 文件名/目录名解析 | 正则提取标题、话数、卷号 | 兜底 |

刮削顺序建议：本地元数据 → 远程 API（按配置优先级）→ 文件名解析。

### 分类整理方式

- **分类维度**：作品 → 卷/话（章节）；可按标签、作者、出版社再分组。
- **命名规则**：支持规则引擎，例如：
  - 作品目录：`{标题} ({年份})` 或 `{标题}/`
  - 话/卷目录或文件：`第{n}话`、`Ch{n}`、`{标题} - {n}.cbz`
- **整理动作**：按规则自动/半自动重命名、移动到目标目录、打标签；可基于刮削得到的元数据（标题、卷号、话数）生成目标路径与文件名。

---

## 2. 影视（Video）

### 资源类型

- 类型标识：`video`
- 最小单位：电影为单文件；剧集为单集（SxxExx）
- 支持电影、剧集、纪录片等

### 支持格式

| 格式 | 扩展名 | 说明 | 优先级 |
|------|--------|------|--------|
| MP4 | .mp4 | H.264/H.265 | 高 |
| MKV | .mkv | Matroska，多音轨/字幕 | 高 |
| AVI | .avi | 传统容器 | 中 |
| MOV | .mov | QuickTime | 中 |
| WebM | .webm | Web 常用 | 低 |

### 源文件与目录结构

```
库根目录/
├── 电影名 (年份)/
│   └── 电影名.年份.分辨率.片源.mp4
├── 剧集名/
│   ├── Season 01/
│   │   ├── S01E01 - 集标题.mkv
│   │   ├── S01E02 - 集标题.mkv
│   │   └── ...
│   ├── Season 02/
│   │   └── ...
│   └── 剧集名.nfo        # 可选，本地元数据
└── ...
```

- **源文件**：上述视频文件；可含 `.nfo`、同名字幕（.srt/.ass/.vtt）等。

### 刮削方式

| 方式 | 说明 | 优先级 |
|------|------|--------|
| 本地 NFO | 解析 Kodi/Emby 等兼容 NFO | 高（优先） |
| TMDB | The Movie Database，电影/剧集 | 高 |
| 豆瓣电影 | 电影/剧集中文元数据 | 高 |
| IMDb | 电影/剧集 | 中 |
| 文件名/目录名解析 | 正则提取片名、年份、SxxExx | 兜底 |

刮削顺序建议：本地 NFO → TMDB/豆瓣（按配置）→ 文件名解析。

### 分类整理方式

- **分类维度**：电影 / 剧集（按季、按集）；可按类型、年份、标签分组。
- **命名规则**：例如：
  - 电影：`{片名} ({年份}).{分辨率}.{片源}.{ext}`
  - 剧集：`S{season}E{episode} - {集标题}.{ext}` 或 `{剧集名}/Season {n}/...`
- **整理动作**：按规则重命名、移动到「电影/剧集/季」目录结构、挂载字幕、写 NFO；可依据 TMDB/豆瓣 的 ID 做唯一关联，避免重复刮削。

---

## 3. 音乐（Music）

### 资源类型

- 类型标识：`music`
- 最小单位：单曲；聚合为专辑、艺术家
- 支持专辑、单曲、播放列表（逻辑集合）

### 支持格式

| 格式 | 扩展名 | 说明 | 优先级 |
|------|--------|------|--------|
| MP3 | .mp3 | 常用，含 ID3 | 高 |
| FLAC | .flac | 无损，含 Vorbis Comment | 高 |
| AAC | .aac, .m4a | Apple 常用 | 中 |
| OGG | .ogg | 开源 | 中 |
| WAV | .wav | 未压缩 | 低 |

### 源文件与目录结构

```
库根目录/
├── 艺术家名/
│   ├── 专辑名 (年份)/
│   │   ├── 01 - 曲目标题.mp3
│   │   ├── 02 - 曲目标题.flac
│   │   ├── cover.jpg
│   │   └── ...
│   ├── 另一专辑 (年份)/
│   │   └── ...
│   └── ...
└── ...
```

- **源文件**：上述音频文件；可含 `cover.jpg`、`albumart.*`、内嵌封面与标签。

### 刮削方式

| 方式 | 说明 | 优先级 |
|------|------|--------|
| ID3 / Vorbis Comment 等内嵌标签 | 文件内艺术家、专辑、曲序、年份等 | 高（优先） |
| MusicBrainz | 按专辑/曲目/艺术家匹配 | 高 |
| Last.fm / Discogs | 补充封面、风格等 | 中 |
| 文件名/目录名解析 | 艺术家/专辑/曲序-曲名 | 兜底 |

刮削顺序建议：内嵌标签 → MusicBrainz 等 → 文件名解析。

### 分类整理方式

- **分类维度**：艺术家 → 专辑 → 曲目；可按风格、年份、播放列表分组。
- **命名规则**：例如：
  - 专辑目录：`{专辑名} ({年份})`
  - 曲目文件：`{曲序} - {曲名}.{ext}` 或 `{曲序}.{曲名}.{ext}`
- **整理动作**：按规则重命名、补齐封面、统一标签（如统一艺术家名、专辑名）、移动到「艺术家/专辑」目录；可依据 MusicBrainz ID 做唯一关联。

---

## 4. 小说（Novel）

### 资源类型

- 类型标识：`novel`
- 最小单位：单本电子书或单章（如 TXT 分章）
- 支持电子书、网文分章等

### 支持格式

| 格式 | 扩展名 | 说明 | 优先级 |
|------|--------|------|--------|
| TXT | .txt | 纯文本，可按文件名或内容分章 | 高 |
| EPUB | .epub | 电子书标准，内嵌元数据与目录 | 高 |
| MOBI | .mobi | Kindle | 中 |
| PDF | .pdf | 文档 | 中 |
| FB2 | .fb2 | FictionBook | 低 |

### 源文件与目录结构

```
库根目录/
├── 书名/
│   ├── 书名.epub
│   ├── cover.jpg
│   └── 章节可拆分为 .txt 时：
│       ├── 第001章.txt
│       ├── 第002章.txt
│       └── ...
├── 单本.epub
└── ...
```

- **源文件**：上述电子书文件及可选封面、分章 TXT。

### 刮削方式

| 方式 | 说明 | 优先级 |
|------|------|--------|
| EPUB/MOBI 内嵌元数据 | 书名、作者、ISBN、目录等 | 高（优先） |
| Goodreads / 豆瓣读书 | 按 ISBN/书名/作者匹配 | 高 |
| 文件名/目录名解析 | 书名、作者、章节号 | 兜底 |

刮削顺序建议：电子书内嵌元数据 → Goodreads/豆瓣 → 文件名解析。

### 分类整理方式

- **分类维度**：书名（或系列）→ 卷/章；可按作者、标签分组。
- **命名规则**：例如：
  - 目录：`{书名}` 或 `{作者} - {书名}`
  - 单文件：`{书名}.epub`；分章：`第{n}章.txt` 或 `Ch{n}.txt`
- **整理动作**：按规则重命名、移动到「作者/书名」或「书名/卷」结构、打标签；可依据 ISBN 或书名+作者做唯一关联。

---

## 5. 自定义类型

- 通过插件扩展新资源类型，需在后台/服务端配置：**类型标识、支持格式（扩展名）、推荐目录结构、刮削方式（本地/远程）、分类整理规则**。
- 格式、源文件结构、刮削方式、分类整理方式均由插件与规则引擎定义，与上述四类同一套规则与配置入口。

---

## 文档导航

- [产品立项说明](./00_project_overview.md) — 产品形态与范围
- [资源类型扩展规划](./04_resource_types_expansion.md) — 各类型实现计划与统一抽象
- [插件系统设计方案](./06_plugin_system_design.md) — 插件与规则引擎

---

**状态**：未评审 (unreview)  
**最后更新**：2026-01-30 · 版本 1.0.0
